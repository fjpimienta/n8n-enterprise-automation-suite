<div class="modal-backdrop fade show"></div>

<div class="modal modal-blur fade show d-block" tabindex="-1" role="dialog">
  <div class="modal-dialog modal-dialog-centered" role="document">
    <div class="modal-content shadow-lg border-0 touch-modal">
      
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title d-flex align-items-center">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M4 6.5l0 10.5l12.5 0a2.5 2.5 0 0 0 2.5 -2.5v-6.5l-4 -3l-5 0l-3 3z" /><path d="M4 17h13.8a2.2 2.2 0 0 1 2.2 2.2a1 1 0 0 1 -1 1h-14a1 1 0 0 1 -1 -1v-2.2" /></svg>
          Check-out: Patín #{{ data().metadata.skate_number }}
        </h5>
        <button type="button" class="btn-close btn-close-white" (click)="close()"></button>
      </div>

      <div class="modal-body p-4">
        
        <div class="row text-center mb-4">
          <div class="col-4 border-end">
            <div class="text-muted small text-uppercase fw-bold">Entrada</div>
            <div class="h3 mb-0">{{ data().start_time | slice:0:5 }}</div>
          </div>
          <div class="col-4 border-end">
            <div class="text-muted small text-uppercase fw-bold">Salida</div>
            <div class="h3 mb-0">{{ currentTime }}</div>
          </div>
          <div class="col-4">
            <div class="text-muted small text-uppercase fw-bold">Total Min</div>
            <div class="h3 mb-0 text-primary">{{ minutesElapsed }} min</div>
          </div>
        </div>

        <div class="mb-4">
          <label class="form-selectgroup-item w-100">
            <input type="checkbox" [checked]="zamboniApplied()" (change)="toggleZamboni()" class="form-selectgroup-input">
            <span class="form-selectgroup-label d-flex align-items-center p-3 touch-toggle">
              <span class="me-3">
                <span class="form-selectgroup-check"></span>
              </span>
              <span class="form-selectgroup-label-content">
                <span class="fw-bold d-block">Aplicar Zamboni / Mantenimiento</span>
                <span class="text-muted small">Resta 15 minutos al tiempo total</span>
              </span>
              <span class="ms-auto">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon text-azure" width="32" height="32" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" fill="none"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 21l18 0" /><path d="M5 21v-7l8 -4l8 4v7" /><path d="M19 21v-2a10 10 0 0 0 -6 -10" /></svg>
              </span>
            </span>
          </label>
        </div>

        <div class="card bg-primary-lt border-primary mb-4">
          <div class="card-body text-center py-4">
            <div class="text-uppercase text-muted fw-bold small">Total a Pagar</div>
            <div class="display-3 fw-bold text-primary">
              ${{ totalAmount() | number:'1.2-2' }}
            </div>
            @if (zamboniApplied()) {
              <div class="badge bg-azure-lt mt-2">Descuento Zamboni Aplicado</div>
            }
          </div>
        </div>

        <div class="mb-2">
          <label class="form-label text-muted small text-uppercase fw-bold">Método de Pago</label>
          <div class="row g-2">
            <div class="col-6">
              <button class="btn w-100 btn-lg payment-btn" 
                [class.btn-dark]="paymentMethod() === 'CASH'" 
                [class.btn-outline-secondary]="paymentMethod() !== 'CASH'"
                (click)="paymentMethod.set('CASH')">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12m-3 0a3 3 0 1 0 6 0a3 3 0 1 0 -6 0" /><path d="M3 6m0 2a2 2 0 0 1 2 -2h14a2 2 0 0 1 2 2v10a2 2 0 0 1 -2 2h-14a2 2 0 0 1 -2 -2z" /></svg>
                Efectivo
              </button>
            </div>
            <div class="col-6">
              <button class="btn w-100 btn-lg payment-btn" 
                [class.btn-dark]="paymentMethod() === 'CARD'" 
                [class.btn-outline-secondary]="paymentMethod() !== 'CARD'"
                (click)="paymentMethod.set('CARD')">
                <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M3 5m0 3a3 3 0 0 1 3 -3h12a3 3 0 0 1 3 3v8a3 3 0 0 1 -3 3h-12a3 3 0 0 1 -3 -3z" /><path d="M3 10l18 0" /><path d="M7 15l.01 0" /><path d="M11 15l2 0" /></svg>
                Tarjeta
              </button>
            </div>
          </div>
        </div>

      </div>

      <div class="modal-footer p-3 bg-light">
        <button type="button" class="btn btn-link link-secondary me-auto" (click)="close()">Cancelar</button>
        <button type="button" class="btn btn-success btn-lg px-4 fw-bold" (click)="confirmCheckout()">
          <svg xmlns="http://www.w3.org/2000/svg" class="icon me-2" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M5 12l5 5l10 -10" /></svg>
          COBRAR Y SALIR
        </button>
      </div>
    </div>
  </div>
</div>